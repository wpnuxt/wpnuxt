# Login mutation for WPGraphQL JWT Authentication
mutation Login($username: String!, $password: String!) {
  login(input: { username: $username, password: $password }) {
    authToken
    refreshToken
    user {
      id
      databaseId
      name
      email
      firstName
      lastName
      username
      avatar {
        url
      }
      roles {
        nodes {
          name
        }
      }
    }
  }
}

# Refresh auth token mutation
mutation RefreshAuthToken($refreshToken: String!) {
  refreshJwtAuthToken(input: { jwtRefreshToken: $refreshToken }) {
    authToken
  }
}

# Register a new user (requires WPGraphQL registration to be enabled)
mutation RegisterUser($username: String!, $email: String!, $password: String!) {
  registerUser(input: { username: $username, email: $email, password: $password }) {
    user {
      id
      databaseId
      username
      email
      name
    }
  }
}

# Update the current user's profile
mutation UpdateUser($id: ID!, $firstName: String, $lastName: String, $nickname: String, $description: String) {
  updateUser(input: { id: $id, firstName: $firstName, lastName: $lastName, nickname: $nickname, description: $description }) {
    user {
      id
      databaseId
      username
      email
      firstName
      lastName
      nickname
      name
      description
    }
  }
}

# Send password reset email
mutation SendPasswordResetEmail($username: String!) {
  sendPasswordResetEmail(input: { username: $username }) {
    success
  }
}

# Reset password with key from email
mutation ResetUserPassword($key: String!, $login: String!, $password: String!) {
  resetUserPassword(input: { key: $key, login: $login, password: $password }) {
    user {
      id
      databaseId
      username
      email
    }
  }
}
